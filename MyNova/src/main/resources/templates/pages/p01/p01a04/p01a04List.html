<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">

<head>
  <meta charset="UTF-8">
  <title>P01A04 서버 리스트</title>
  <style>
    body { font-family: "Segoe UI", Arial, sans-serif; font-size: 0.95rem; }
    h2 { margin-bottom: 1rem; }

    .toolbar {
      display:flex; justify-content:space-between; align-items:center;
      gap:0.5rem; margin-bottom:1rem;
    }
    .toolbar input {
      padding:0.4rem; border:1px solid #ccc; border-radius:4px;
    }
    .btn {
      background:#2563eb; color:white; border:none; border-radius:4px;
      padding:0.45rem 0.9rem; cursor:pointer; font-size:0.9rem;
    }
    .btn:hover { background:#1e40af; }
    .btn.red { background:#dc2626; }
    .btn.gray { background:#6b7280; }

    table { width:100%; border-collapse:collapse; }
    th, td {
      border:1px solid #ddd; padding:8px; text-align:center;
    }
    th { background:#f3f4f6; }
    td a { color:#2563eb; cursor:pointer; text-decoration:underline; }

    .pagination {
      display:flex; justify-content:center; margin-top:1rem; gap:4px;
    }
    .pagination button {
      border: 1px solid #ccc;
      padding: 5px 10px;
      margin: 0 2px;
      cursor: pointer;
      border-radius: 4px;
      background-color: white;
    }
    .pagination button.active {
      background-color: #2563eb;
      color: white;
      border-color: #2563eb;
    }
    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* ✅ 모달 */
    .modal {
      display:none; position:fixed; z-index:3000; left:0; top:0;
      width:100%; height:100%; background:rgba(0,0,0,0.5);
    }
    .modal-content {
      background:white; width:90%; max-width:450px; padding:1rem;
      border-radius:0.5rem; position:absolute; top:50%; left:50%;
      transform:translate(-50%, -50%);
    }
    .modal-header { display:flex; justify-content:space-between; align-items:center; }
    .modal-header h3 { margin:0; }
    .form-group { margin:0.5rem 0; text-align:left; }
    .form-group label { display:block; font-size:0.85rem; margin-bottom:0.25rem; }
    .form-group input {
      width:100%; padding:0.4rem; border:1px solid #ccc; border-radius:4px;
    }
    .modal-footer { display:flex; justify-content:flex-end; gap:0.5rem; }
  </style>
</head>

<body>
<div layout:fragment="content">
  <h2>P01A04 서버 리스트</h2>

  <!-- 🔍 검색 / 액션 -->
  <div class="toolbar">
    <div>
      <input type="text" id="searchInput" placeholder="검색어 입력" />
      <button id="searchBtn" class="btn">검색</button>
      <button id="deleteSelectedBtn" class="btn red">삭제</button>
    </div>
    <div>
      <button id="excelBtn" class="btn">엑셀 다운로드</button>
      <button id="addBtn" class="btn">추가</button>
    </div>
  </div>

  <!-- 📋 데이터 테이블 -->
  <table>
    <thead>
      <tr>
        <th><input type="checkbox" id="checkAll" /></th>
        <th>No</th>
        <th>제목</th>
        <th>담당자</th>
        <th>등록일</th>
      </tr>
    </thead>
    <tbody id="dataTable"></tbody>
  </table>

  <div id="pagination" class="pagination"></div>

  <!-- ➕ 등록 모달 -->
  <div id="addModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>항목 등록</h3>
        <span data-close="addModal" style="cursor:pointer;">&times;</span>
      </div>
      <div class="form-group">
        <label>제목</label>
        <input type="text" id="titleInput" />
      </div>
      <div class="form-group">
        <label>담당자</label>
        <input type="text" id="ownerInput" />
      </div>
      <div class="modal-footer">
        <button id="saveBtn" class="btn">저장</button>
        <button class="btn gray" data-close="addModal">닫기</button>
      </div>
    </div>
  </div>

  <!-- 🔍 상세 / 수정 모달 -->
  <div id="detailModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>상세 정보</h3>
        <span data-close="detailModal" style="cursor:pointer;">&times;</span>
      </div>
      <div class="form-group">
        <label>No</label>
        <input id="detailId" readonly />
      </div>
      <div class="form-group">
        <label>제목</label>
        <input id="detailTitle" />
      </div>
      <div class="form-group">
        <label>담당자</label>
        <input id="detailOwner" />
      </div>
      <div class="form-group">
        <label>등록일</label>
        <input id="detailRegDate" readonly />
      </div>
      <div class="modal-footer">
        <button id="updateBtn" class="btn">수정</button>
        <button class="btn gray" data-close="detailModal">닫기</button>
      </div>
    </div>
  </div>
</div>

<!-- ✅ 페이지별 스크립트 -->
<th:block layout:fragment="pageScript">
  <script src="/js/commonUnifiedList.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      initUnifiedList({
        mode: "p01a04",              // 서버 구분
        apiUrl: "/api/p01a04",       // REST 엔드포인트
        tableBodySelector: "#dataTable",
        paginationSelector: "#pagination",
        searchInputSelector: "#searchInput",
        searchBtnSelector: "#searchBtn",
        addBtnSelector: "#addBtn",
        modalId: "#addModal",
        saveBtnSelector: "#saveBtn",
        closeBtnSelector: "[data-close]",
        checkAllSelector: "#checkAll",
        deleteSelectedBtnSelector: "#deleteSelectedBtn",
        detailModalId: "#detailModal",
        detailFields: {
          id: "#detailId",
          title: "#detailTitle",
          owner: "#detailOwner",
          regDate: "#detailRegDate"
        },
        updateBtnSelector: "#updateBtn",
        excelBtnSelector: "#excelBtn",
        columns: [
          { key: "id", label: "No" },
          { key: "title", label: "제목", isDetailLink: true },
          { key: "owner", label: "담당자" },
          { key: "regDate", label: "등록일" }
        ]
      });
    });
  </script>
</th:block>

</body>
</html>
